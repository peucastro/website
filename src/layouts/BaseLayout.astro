---
import "@styles/global.css";
import BaseHead from "@components/common/BaseHead.astro";
import Footer from "@components/common/Footer.svelte";
import Header from "@components/common/Header.svelte";

interface Props {
  title?: string;
  description?: string;
  image?: string;
}

const {
  title,
  description = "personal website and portfolio.",
  image,
} = Astro.props;

const siteName = "pedro castro";
const fullTitle = title ? `${title} | ${siteName}` : siteName;
const currentPath = Astro.url.pathname;
---

<html lang="en" dir="ltr">
  <head>
    <BaseHead title={fullTitle} description={description} image={image} />

    <script is:inline>
      (function () {
        const getThemePreference = () => {
          const saved =
            typeof localStorage !== "undefined" &&
            localStorage.getItem("theme");
          if (saved) return saved;

          return window.matchMedia("(prefers-color-scheme: light)").matches
            ? "light"
            : "dark";
        };

        const theme = getThemePreference();
        const root = document.documentElement;

        root.classList.toggle("light", theme === "light");

        window
          .matchMedia("(prefers-color-scheme: light)")
          .addEventListener("change", (e) => {
            if (!localStorage.getItem("theme")) {
              root.classList.toggle("light", e.matches);
            }
          });
      })();
    </script>
  </head>
  <body>
    <Header {currentPath} />
    <main class="mx-auto mt-12 mb-12 min-h-screen max-w-5xl px-6">
      <slot />
    </main>
    <Footer client:visible />
  </body>
</html>
